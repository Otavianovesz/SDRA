# SRDA-Rural Extraction Patterns Configuration
# ============================================
# This file defines the regex patterns used for extracting data from documents.
# Format:
#   field_name:
#     DOC_TYPE:
#       - pattern: "regex_string"
#         confidence: 0.0-1.0
#         description: "Optional description of what this matches"

# ------------------------------------------------------------------------------
# DOCUMENT NUMBER PATTERNS
# ------------------------------------------------------------------------------
doc_number:
  # NFE, NFSE, FATURA share patterns
  NFE:
    - pattern: 'NF-?[eE]?[\s\n:]*N[°ºo.]?[\s]*([\d\.]+)'
      confidence: 0.98
      description: "Standard NF-e Number format"

    - pattern: 'N[úu]mero\s*(?:do)?\s*documento[\s\n:]*(\d{1,9})'
      confidence: 0.95
      description: "Explicit 'Número do documento'"

    - pattern: 'N[úu]mero\s*(?:da)?\s*Nota[\s\n:]*(\d{1,9})'
      confidence: 0.98
      description: "Common NFSE format 'Número da Nota'"

    - pattern: 'N[úu]mero\s*(?:da)?\s*NFS?-?[eE][\s\n:]*(\d{1,9})'
      confidence: 0.95
      description: "Explicit NFS-e number"

    - pattern: 'S[ée]rie\s*\d*[\s\n]*N[°ºo.]?[\s]*([\d\.]+)'
      confidence: 0.90
      description: "Series and Number combination"

    - pattern: 'NOTA\s*FISCAL[^\n]*N[°ºo.]?[\s:]*([\d\.]+)'
      confidence: 0.85
      description: "Nota Fiscal label"

    # NEW PATTERNS (v38/v39 improvements)
    - pattern: 'N[úu]mero[\s:]+(\d{3,9})'
      confidence: 0.92
      description: "Simple Number label"

    - pattern: 'NOTA\s+(\d{3,9})'
      confidence: 0.88
      description: "Direct NOTA X label"

    - pattern: 'NF-?[eE]?[:\s]+([\d\.]+)'
      confidence: 0.90
      description: "NFe: Number format"

    - pattern: 'NFS-?e?\s*n[°º]\s*(\d{1,9})'
      confidence: 0.95
      description: "NFS-e lowercase n format"

    - pattern: 'N[°º]\s*(?:da)?\s*Nota[\s:]*(\d+)'
      confidence: 0.90
      description: "Abbreviated Nº da Nota"

  BOLETO:
    - pattern: 'Nosso\s*N[°ºu]?(?:mero)?[\s\n:]*([\d\.]+)'
      confidence: 0.95
      description: "Nosso Número (Boleto standard)"

    - pattern: 'N[°ºu](?:mero)?\s*(?:do)?\s*Documento[\s\n:]*([\d\.]+)'
      confidence: 0.90
      description: "Número do Documento label"

    - pattern: 'Nro\.?\s*Documento[\s\n]+[\d\s-]*([\d]+)(?:/\d)?'
      confidence: 0.92
      description: "Sicredi format"

    - pattern: 'Referente\s+aos?\s+Documentos?[\s\n:]*(?:\d+\s+-\s+)?([\d]+)'
      confidence: 0.88
      description: "Referente aos Documentos"

    - pattern: 'NF-?\s*(\d{3,9})'
      confidence: 0.85
      description: "NF reference in Boleto instructions"

    - pattern: 'REF\.?\s*(?:NF|NOTA)[\s:]*(\d{3,9})'
      confidence: 0.85
      description: "Ref NF instruction"

  COMPROVANTE:
    - pattern: '(?:AUTENTICACAO|Autentica[çc][ãa]o)[\s:]+([A-Z0-9\.\-]+)'
      confidence: 0.95
      description: "Bank Authentication Code"

    - pattern: 'DOCUMENTO[:\s]+(\d+)'
      confidence: 0.90
      description: "BB Document number"

    - pattern: 'ID[:\s]+([A-Z0-9]+)'
      confidence: 0.80
      description: "PIX Transaction ID"

  GENERIC:
    - pattern: 'N[°º\.]?[\s]*([\d\.]{4,15})'
      confidence: 0.50
      description: "Low confidence generic number search"

# ------------------------------------------------------------------------------
# SUPPLIER PATTERNS (Regex-based backup to GLiNER)
# ------------------------------------------------------------------------------
supplier:
  NFE:
    - pattern: 'RECEBEMOS\s+DE\s+([A-Z][A-Z0-9\s\.,\-]+?)\s+(?:OS\s+PRODUTOS|OS\s+SERVICOS)'
      confidence: 0.98
      description: "Recebemos de X footer"

    - pattern: 'Identifica[cç][aã]o\s*do\s*emitente[\s\n]+([A-Z][A-Z0-9\s\.\-]+)'
      confidence: 0.90
      description: "Identificação do Emitente header"

    - pattern: 'EMITENTE[\s\n:]+([^\n]+)'
      confidence: 0.85
      description: "Emitente label"

    - pattern: 'Raz[aã]o\s*[Ss]ocial[\s\n:]+([^\n]+)'
      confidence: 0.80
      description: "Razão Social label"

  BOLETO:
    # SICOOB format: Company name with & symbol after Cedente block
    - pattern: '([A-Z][A-Z0-9\s,&\.\-]{5,}(?:LTDA|CIA|EIRELI|ME|EPP|S\.?A\.?))\s+\d{4}\s*/\s*\d+'
      confidence: 0.98
      description: "Company name followed by Agencia/Codigo pattern"

    # SICREDI format: Beneficiário label followed by company name on new line
    - pattern: 'Benefici[aá]rio\s*:\s*\n*([A-Z][A-Z0-9\s,&\.\-]+(?:LTDA|EIRELI|ME|EPP)?)'
      confidence: 0.97
      description: "Beneficiário with colon and newline"

    - pattern: 'Benefici[aá]rio[:\s\n]+([A-Z][A-Z0-9\s,&\.\-]+?(?:LTDA|EIRELI|ME|EPP|S\.?A\.?))'
      confidence: 0.96
      description: "Beneficiário with corporate suffix"

    # CNPJ followed by company name pattern
    - pattern: 'C\.?N\.?P\.?J\.?\s*:?\s*[\d\.\/\-]+\s+([A-Z][A-Z0-9\s,&\.\-]{8,})'
      confidence: 0.95
      description: "CNPJ label followed by company name"

    # Cedente format (used by SICOOB, Banco do Brasil)
    - pattern: 'Cedente[:\s\n]+([A-Z][A-Z0-9\s,&\.\-]{8,})'
      confidence: 0.94
      description: "Cedente label with multiline support"

    # Pattern to capture company names with & symbol
    - pattern: '([A-Z][A-Z\s]{3,}\s*&\s*[A-Z][A-Z\s]+(?:LTDA|CIA)?)'
      confidence: 0.90
      description: "Company with & symbol (e.g., CADORE & CIA)"

    # Fallback: CNPJ line followed by name
    - pattern: '\d{2}\.\d{3}\.\d{3}/\d{4}-\d{2}[\s\n]+([A-Z][A-Z0-9\s\.\-]{8,})'
      confidence: 0.88
      description: "CNPJ followed by Name"

  COMPROVANTE:
    - pattern: 'PAGO\s+PARA[:\s]+(?:[\d\.]+\s+)?([A-Za-z][A-Za-z\s]+)'
      confidence: 0.98
      description: "BB PIX Pago Para - beneficiary name"

    - pattern: 'FAVORECIDO[:\s]+([A-Z][A-Z0-9\s\.\-]+)'
      confidence: 0.97
      description: "TED/DOC Favorecido field"

    - pattern: 'DESTINATARIO[:\s]+([A-Z][A-Z0-9\s\.\-]+)'
      confidence: 0.95
      description: "Destinatário field"

    - pattern: 'NOME[:\s]+([A-Z][A-Z0-9\s\.\-]+)'
      confidence: 0.85
      description: "Generic Nome field"

  NFSE:
    - pattern: 'Raz[aã]o\s*[Ss]ocial[\s\n:]+([A-Z][A-Z0-9\s\.\-]+)'
      confidence: 0.95
      description: "NFSE Razão Social"

    - pattern: 'PRESTADOR[\s\n]+(?:DE\s+SERVI[ÇC]OS?)?[\s\n:]+([A-Z][A-Z0-9\s\.\-]+)'
      confidence: 0.90
      description: "Prestador de Serviços block"

    - pattern: '(?:Nome|Raz[aã]o)\s*(?:do\s*)?Prestador[\s\n:]+([^\n]+)'
      confidence: 0.85
      description: "Nome do Prestador label"

  GENERIC:
    - pattern: 'EMITENTE[\s\n:]+([^\n]+)'
      confidence: 0.70
      description: "Generic Emitente label"

    - pattern: 'Raz[aã]o\s*Social[\s\n:]+([^\n]+)'
      confidence: 0.70
      description: "Generic Razão Social label"
