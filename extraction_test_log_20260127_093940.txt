2026-01-27 09:39:40,425 - INFO - Iniciando teste em: 11.2025_NOVEMBRO_1.547
2026-01-27 09:39:40,426 - INFO - Limite de arquivos: Sem limite
2026-01-27 09:39:40,426 - INFO - Saída JSON: extraction_test_results.json
2026-01-27 09:39:40,438 - INFO - 
######################################################################
2026-01-27 09:39:40,438 - INFO - # TESTE COMPLETO DE EXTRAÇÃO SRDA-Rural
2026-01-27 09:39:40,439 - INFO - # Pasta: 11.2025_NOVEMBRO_1.547
2026-01-27 09:39:40,439 - INFO - # Total de arquivos: 2568
2026-01-27 09:39:40,439 - INFO - # Início: 2026-01-27T09:39:40.439097
2026-01-27 09:39:40,439 - INFO - ######################################################################

2026-01-27 09:39:40,439 - INFO - 
[1/2568] Processando: 01.11.2025_MV_CADORE BIDOIA_3.108,00_BOLETO_FECHAMENTO.pdf
2026-01-27 09:39:40,439 - INFO - 
============================================================
2026-01-27 09:39:40,439 - INFO - TESTANDO: 01.11.2025_MV_CADORE BIDOIA_3.108,00_BOLETO_FECHAMENTO.pdf
2026-01-27 09:39:40,439 - INFO - ============================================================
2026-01-27 09:39:40,439 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:40,440 - DEBUG - Parsed '01.11.2025_MV_CADORE BIDOIA_3.108,00_BOLETO_FECHAMENTO.pdf':
2026-01-27 09:39:40,440 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:40,440 - DEBUG -   Entidade: MV
2026-01-27 09:39:40,440 - DEBUG -   Fornecedor: CADORE BIDOIA
2026-01-27 09:39:40,440 - DEBUG -   Valor: 3.108,00 (310800 cents)
2026-01-27 09:39:40,440 - DEBUG -   Tipo: BOLETO
2026-01-27 09:39:40,440 - DEBUG -   Número: FECHAMENTO
2026-01-27 09:39:40,440 - DEBUG -   Parcela: None
2026-01-27 09:39:40,440 - INFO - Extraindo dados do documento...
2026-01-27 09:39:41,817 - INFO - PyTorch configured: CPU-only, threads=4, grad=disabled
2026-01-27 09:39:42,017 - ERROR - Erro na extração de '01.11.2025_MV_CADORE BIDOIA_3.108,00_BOLETO_FECHAMENTO.pdf': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,018 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,018 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,018 - INFO - 
[2/2568] Processando: 01.11.2025_MV_CADORE BIDOIA_850,00_NFE_732177.pdf
2026-01-27 09:39:42,018 - INFO - 
============================================================
2026-01-27 09:39:42,018 - INFO - TESTANDO: 01.11.2025_MV_CADORE BIDOIA_850,00_NFE_732177.pdf
2026-01-27 09:39:42,018 - INFO - ============================================================
2026-01-27 09:39:42,018 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:42,018 - DEBUG - Parsed '01.11.2025_MV_CADORE BIDOIA_850,00_NFE_732177.pdf':
2026-01-27 09:39:42,018 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:42,018 - DEBUG -   Entidade: MV
2026-01-27 09:39:42,018 - DEBUG -   Fornecedor: CADORE BIDOIA
2026-01-27 09:39:42,018 - DEBUG -   Valor: 850,00 (85000 cents)
2026-01-27 09:39:42,018 - DEBUG -   Tipo: NFE
2026-01-27 09:39:42,018 - DEBUG -   Número: 732177
2026-01-27 09:39:42,018 - DEBUG -   Parcela: None
2026-01-27 09:39:42,018 - INFO - Extraindo dados do documento...
2026-01-27 09:39:42,112 - ERROR - Erro na extração de '01.11.2025_MV_CADORE BIDOIA_850,00_NFE_732177.pdf': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,112 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,112 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,112 - INFO - 
[3/2568] Processando: 01.11.2025_MV_SANTA CLARA_270,00_BOLETO_111534.PDF
2026-01-27 09:39:42,112 - INFO - 
============================================================
2026-01-27 09:39:42,112 - INFO - TESTANDO: 01.11.2025_MV_SANTA CLARA_270,00_BOLETO_111534.PDF
2026-01-27 09:39:42,112 - INFO - ============================================================
2026-01-27 09:39:42,113 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:42,113 - DEBUG - Parsed '01.11.2025_MV_SANTA CLARA_270,00_BOLETO_111534.PDF':
2026-01-27 09:39:42,113 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:42,113 - DEBUG -   Entidade: MV
2026-01-27 09:39:42,113 - DEBUG -   Fornecedor: SANTA CLARA
2026-01-27 09:39:42,113 - DEBUG -   Valor: 270,00 (27000 cents)
2026-01-27 09:39:42,113 - DEBUG -   Tipo: BOLETO
2026-01-27 09:39:42,113 - DEBUG -   Número: 111534
2026-01-27 09:39:42,113 - DEBUG -   Parcela: None
2026-01-27 09:39:42,113 - INFO - Extraindo dados do documento...
2026-01-27 09:39:42,206 - ERROR - Erro na extração de '01.11.2025_MV_SANTA CLARA_270,00_BOLETO_111534.PDF': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,207 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,207 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,207 - INFO - 
[4/2568] Processando: 01.11.2025_MV_SANTA CLARA_270,00_NFE_111534.pdf
2026-01-27 09:39:42,207 - INFO - 
============================================================
2026-01-27 09:39:42,207 - INFO - TESTANDO: 01.11.2025_MV_SANTA CLARA_270,00_NFE_111534.pdf
2026-01-27 09:39:42,207 - INFO - ============================================================
2026-01-27 09:39:42,207 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:42,207 - DEBUG - Parsed '01.11.2025_MV_SANTA CLARA_270,00_NFE_111534.pdf':
2026-01-27 09:39:42,207 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:42,207 - DEBUG -   Entidade: MV
2026-01-27 09:39:42,207 - DEBUG -   Fornecedor: SANTA CLARA
2026-01-27 09:39:42,207 - DEBUG -   Valor: 270,00 (27000 cents)
2026-01-27 09:39:42,207 - DEBUG -   Tipo: NFE
2026-01-27 09:39:42,207 - DEBUG -   Número: 111534
2026-01-27 09:39:42,207 - DEBUG -   Parcela: None
2026-01-27 09:39:42,207 - INFO - Extraindo dados do documento...
2026-01-27 09:39:42,303 - ERROR - Erro na extração de '01.11.2025_MV_SANTA CLARA_270,00_NFE_111534.pdf': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,303 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,303 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,303 - INFO - 
[5/2568] Processando: 01.11.2025_MV_SANTA CLARA_81,00_BOLETO_111535.PDF
2026-01-27 09:39:42,303 - INFO - 
============================================================
2026-01-27 09:39:42,303 - INFO - TESTANDO: 01.11.2025_MV_SANTA CLARA_81,00_BOLETO_111535.PDF
2026-01-27 09:39:42,303 - INFO - ============================================================
2026-01-27 09:39:42,303 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:42,303 - DEBUG - Parsed '01.11.2025_MV_SANTA CLARA_81,00_BOLETO_111535.PDF':
2026-01-27 09:39:42,303 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:42,303 - DEBUG -   Entidade: MV
2026-01-27 09:39:42,303 - DEBUG -   Fornecedor: SANTA CLARA
2026-01-27 09:39:42,303 - DEBUG -   Valor: 81,00 (8100 cents)
2026-01-27 09:39:42,303 - DEBUG -   Tipo: BOLETO
2026-01-27 09:39:42,303 - DEBUG -   Número: 111535
2026-01-27 09:39:42,303 - DEBUG -   Parcela: None
2026-01-27 09:39:42,303 - INFO - Extraindo dados do documento...
2026-01-27 09:39:42,406 - ERROR - Erro na extração de '01.11.2025_MV_SANTA CLARA_81,00_BOLETO_111535.PDF': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,406 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,407 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,407 - INFO - 
[6/2568] Processando: 01.11.2025_MV_SANTA CLARA_81,00_NFE_111535.pdf
2026-01-27 09:39:42,407 - INFO - 
============================================================
2026-01-27 09:39:42,407 - INFO - TESTANDO: 01.11.2025_MV_SANTA CLARA_81,00_NFE_111535.pdf
2026-01-27 09:39:42,407 - INFO - ============================================================
2026-01-27 09:39:42,407 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:42,407 - DEBUG - Parsed '01.11.2025_MV_SANTA CLARA_81,00_NFE_111535.pdf':
2026-01-27 09:39:42,407 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:42,407 - DEBUG -   Entidade: MV
2026-01-27 09:39:42,407 - DEBUG -   Fornecedor: SANTA CLARA
2026-01-27 09:39:42,407 - DEBUG -   Valor: 81,00 (8100 cents)
2026-01-27 09:39:42,407 - DEBUG -   Tipo: NFE
2026-01-27 09:39:42,407 - DEBUG -   Número: 111535
2026-01-27 09:39:42,407 - DEBUG -   Parcela: None
2026-01-27 09:39:42,407 - INFO - Extraindo dados do documento...
2026-01-27 09:39:42,517 - ERROR - Erro na extração de '01.11.2025_MV_SANTA CLARA_81,00_NFE_111535.pdf': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,518 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,518 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,518 - INFO - 
[7/2568] Processando: 01.11.2025_VG_ABDALLA TRUCK_370,00_BOLETO_20590.pdf
2026-01-27 09:39:42,518 - INFO - 
============================================================
2026-01-27 09:39:42,518 - INFO - TESTANDO: 01.11.2025_VG_ABDALLA TRUCK_370,00_BOLETO_20590.pdf
2026-01-27 09:39:42,518 - INFO - ============================================================
2026-01-27 09:39:42,518 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:42,518 - DEBUG - Parsed '01.11.2025_VG_ABDALLA TRUCK_370,00_BOLETO_20590.pdf':
2026-01-27 09:39:42,518 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:42,518 - DEBUG -   Entidade: VG
2026-01-27 09:39:42,518 - DEBUG -   Fornecedor: ABDALLA TRUCK
2026-01-27 09:39:42,518 - DEBUG -   Valor: 370,00 (37000 cents)
2026-01-27 09:39:42,518 - DEBUG -   Tipo: BOLETO
2026-01-27 09:39:42,518 - DEBUG -   Número: 20590
2026-01-27 09:39:42,518 - DEBUG -   Parcela: None
2026-01-27 09:39:42,518 - INFO - Extraindo dados do documento...
2026-01-27 09:39:42,612 - ERROR - Erro na extração de '01.11.2025_VG_ABDALLA TRUCK_370,00_BOLETO_20590.pdf': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,612 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,613 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,613 - INFO - 
[8/2568] Processando: 01.11.2025_VG_ABDALLA TRUCK_370,00_NFSE_20590.pdf
2026-01-27 09:39:42,613 - INFO - 
============================================================
2026-01-27 09:39:42,613 - INFO - TESTANDO: 01.11.2025_VG_ABDALLA TRUCK_370,00_NFSE_20590.pdf
2026-01-27 09:39:42,613 - INFO - ============================================================
2026-01-27 09:39:42,613 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:42,613 - DEBUG - Parsed '01.11.2025_VG_ABDALLA TRUCK_370,00_NFSE_20590.pdf':
2026-01-27 09:39:42,613 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:42,613 - DEBUG -   Entidade: VG
2026-01-27 09:39:42,613 - DEBUG -   Fornecedor: ABDALLA TRUCK
2026-01-27 09:39:42,613 - DEBUG -   Valor: 370,00 (37000 cents)
2026-01-27 09:39:42,613 - DEBUG -   Tipo: NFSE
2026-01-27 09:39:42,613 - DEBUG -   Número: 20590
2026-01-27 09:39:42,613 - DEBUG -   Parcela: None
2026-01-27 09:39:42,613 - INFO - Extraindo dados do documento...
2026-01-27 09:39:42,707 - ERROR - Erro na extração de '01.11.2025_VG_ABDALLA TRUCK_370,00_NFSE_20590.pdf': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,708 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,708 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,708 - INFO - 
[9/2568] Processando: 01.11.2025_VG_AGRO BAGGIO_2.843,29_5.686,58_PARC 2-2_NFE_414978.pdf
2026-01-27 09:39:42,708 - INFO - 
============================================================
2026-01-27 09:39:42,708 - INFO - TESTANDO: 01.11.2025_VG_AGRO BAGGIO_2.843,29_5.686,58_PARC 2-2_NFE_414978.pdf
2026-01-27 09:39:42,708 - INFO - ============================================================
2026-01-27 09:39:42,708 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:42,708 - DEBUG - Parsed '01.11.2025_VG_AGRO BAGGIO_2.843,29_5.686,58_PARC 2-2_NFE_414978.pdf':
2026-01-27 09:39:42,708 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:42,708 - DEBUG -   Entidade: VG
2026-01-27 09:39:42,708 - DEBUG -   Fornecedor: AGRO BAGGIO
2026-01-27 09:39:42,708 - DEBUG -   Valor: 2.843,29 (284329 cents)
2026-01-27 09:39:42,708 - DEBUG -   Tipo: NFE
2026-01-27 09:39:42,708 - DEBUG -   Número: 414978
2026-01-27 09:39:42,708 - DEBUG -   Parcela: 2-2
2026-01-27 09:39:42,708 - INFO - Extraindo dados do documento...
2026-01-27 09:39:42,800 - ERROR - Erro na extração de '01.11.2025_VG_AGRO BAGGIO_2.843,29_5.686,58_PARC 2-2_NFE_414978.pdf': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,800 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,800 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,800 - INFO - 
[10/2568] Processando: 01.11.2025_VG_AGRO BAGGIO_2.843,29_PARC 2-2_BOLETO_414978.pdf
2026-01-27 09:39:42,800 - INFO - 
============================================================
2026-01-27 09:39:42,800 - INFO - TESTANDO: 01.11.2025_VG_AGRO BAGGIO_2.843,29_PARC 2-2_BOLETO_414978.pdf
2026-01-27 09:39:42,800 - INFO - ============================================================
2026-01-27 09:39:42,800 - INFO - Parseando nome do arquivo...
2026-01-27 09:39:42,800 - DEBUG - Parsed '01.11.2025_VG_AGRO BAGGIO_2.843,29_PARC 2-2_BOLETO_414978.pdf':
2026-01-27 09:39:42,800 - DEBUG -   Data: 01.11.2025
2026-01-27 09:39:42,800 - DEBUG -   Entidade: VG
2026-01-27 09:39:42,800 - DEBUG -   Fornecedor: AGRO BAGGIO
2026-01-27 09:39:42,800 - DEBUG -   Valor: 2.843,29 (284329 cents)
2026-01-27 09:39:42,800 - DEBUG -   Tipo: BOLETO
2026-01-27 09:39:42,800 - DEBUG -   Número: 414978
2026-01-27 09:39:42,800 - DEBUG -   Parcela: 2-2
2026-01-27 09:39:42,800 - INFO - Extraindo dados do documento...
2026-01-27 09:39:42,898 - ERROR - Erro na extração de '01.11.2025_VG_AGRO BAGGIO_2.843,29_PARC 2-2_BOLETO_414978.pdf': IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,898 - ERROR - Traceback (most recent call last):
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\test_complete_extraction.py", line 312, in extract_document
    scanner = CognitiveScanner()
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\scanner.py", line 332, in __init__
    self.db = db or SRDADatabase()
                    ^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 92, in __init__
    self._initialize_database()
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 114, in _initialize_database
    conn = self.connection
           ^^^^^^^^^^^^^^^
  File "C:\Users\otavi\Documents\Projetos_programação\SDRA_2\database.py", line 98, in connection
    self._connection = duckdb.connect(self.db_path)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)

2026-01-27 09:39:42,898 - ERROR - Extração falhou: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,898 - INFO - SMOKE TEST: Limite de 10 arquivos atingido. Parando.
2026-01-27 09:39:42,898 - INFO - 
######################################################################
2026-01-27 09:39:42,898 - INFO - # RESUMO DO TESTE
2026-01-27 09:39:42,898 - INFO - ######################################################################
2026-01-27 09:39:42,898 - INFO - 
TOTAL DE ARQUIVOS: 2568
2026-01-27 09:39:42,898 - INFO -   ✓ Passou:  0 (0.0%)
2026-01-27 09:39:42,898 - INFO -   ✗ Falhou:  10 (0.4%)
2026-01-27 09:39:42,898 - INFO -   ⚠ Erros:   0
2026-01-27 09:39:42,898 - INFO - 
TEMPO DE EXECUÇÃO:
2026-01-27 09:39:42,898 - INFO -   Total:  2.5s
2026-01-27 09:39:42,898 - INFO -   Médio:  1ms/arquivo
2026-01-27 09:39:42,898 - INFO - 
PRECISÃO POR CAMPO:
2026-01-27 09:39:42,898 - INFO - 
PRECISÃO POR TIPO DE DOCUMENTO:
2026-01-27 09:39:42,898 - INFO -   BOLETO         :   0.0% (0/5)
2026-01-27 09:39:42,898 - INFO -   NFE            :   0.0% (0/4)
2026-01-27 09:39:42,898 - INFO -   NFSE           :   0.0% (0/1)
2026-01-27 09:39:42,898 - INFO - 
PRECISÃO POR ENTIDADE:
2026-01-27 09:39:42,898 - INFO -   MV             :   0.0% (0/6)
2026-01-27 09:39:42,898 - INFO -   VG             :   0.0% (0/4)
2026-01-27 09:39:42,899 - INFO - 
======================================================================
2026-01-27 09:39:42,899 - INFO - TOP 20 FALHAS (de 10 total)
2026-01-27 09:39:42,899 - INFO - ======================================================================
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_MV_CADORE BIDOIA_3.108,00_BOLETO_FECHAMENTO.pdf
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 3.108,00 (310800 cents) | MV | CADORE BIDOIA
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_MV_CADORE BIDOIA_850,00_NFE_732177.pdf
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 850,00 (85000 cents) | MV | CADORE BIDOIA
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_MV_SANTA CLARA_270,00_BOLETO_111534.PDF
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 270,00 (27000 cents) | MV | SANTA CLARA
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_MV_SANTA CLARA_270,00_NFE_111534.pdf
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 270,00 (27000 cents) | MV | SANTA CLARA
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_MV_SANTA CLARA_81,00_BOLETO_111535.PDF
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 81,00 (8100 cents) | MV | SANTA CLARA
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_MV_SANTA CLARA_81,00_NFE_111535.pdf
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 81,00 (8100 cents) | MV | SANTA CLARA
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_VG_ABDALLA TRUCK_370,00_BOLETO_20590.pdf
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 370,00 (37000 cents) | VG | ABDALLA TRUCK
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_VG_ABDALLA TRUCK_370,00_NFSE_20590.pdf
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 370,00 (37000 cents) | VG | ABDALLA TRUCK
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_VG_AGRO BAGGIO_2.843,29_5.686,58_PARC 2-2_NFE_414978.pdf
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 2.843,29 (284329 cents) | VG | AGRO BAGGIO
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,899 - INFO - 
01.11.2025_VG_AGRO BAGGIO_2.843,29_PARC 2-2_BOLETO_414978.pdf
2026-01-27 09:39:42,899 - INFO -   Ground Truth: 2.843,29 (284329 cents) | VG | AGRO BAGGIO
2026-01-27 09:39:42,899 - INFO -   Extraído:     None cents | None | None
2026-01-27 09:39:42,899 - INFO -   ERRO: Falha na extração: IO Error: Cannot open file "c:\users\otavi\documents\projetos_programação\sdra_2\srda_rural.db": O arquivo já está sendo usado por outro processo.

File is already open in 
C:\Users\otavi\AppData\Local\Programs\Python\Python312\python.exe (PID 35180)
2026-01-27 09:39:42,901 - INFO - 
Resultados salvos em: extraction_test_results.json
2026-01-27 09:39:42,901 - INFO - Log salvo em: extraction_test_log_20260127_093940.txt
